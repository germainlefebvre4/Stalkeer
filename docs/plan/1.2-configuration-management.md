# Task 1.2: Configuration Management

**Phase**: 1 (Foundation)  
**Complexity**: Small  
**Status**: Completed

## Description

Implement Viper-based configuration system to support flexible configuration from files and environment variables.

## Details

- Create `config.go` in `/internal/config` package
- Support `config.yml` loading with fields:
  - `database`: host, port, user, password, dbname
  - `m3u`: file path, update interval
  - `filters`: array of filter definitions (name, attribute, include patterns, exclude patterns)
    - `attribute` can be `group_title` or `tvg_name` (that match with the m3u playlist attributes)
  - `logging`: level (debug/info/warn/error), format (json/text)
  - `api`: port, address
  - `directories`: download path, sonarr/radarr paths
- Implement environment variable overrides:
  - `DATABASE_URL` for database connection string
  - `M3U_PATH` for playlist file location
  - `LOG_LEVEL` for logging verbosity
  - `API_PORT` for REST API port
- Add configuration validation on startup (check required fields)
- Provide sensible defaults for optional fields
- Create example `config.yml.example` file
- Implement configuration reload capability (for runtime changes)

## Dependencies

- Task 1.1 (Project structure)

## Acceptance Criteria

- [x] Configuration loads successfully from `config.yml`
- [x] Environment variables properly override file values
- [x] Validation catches missing required fields with clear error messages
- [x] Example config file documents all available options
- [x] Configuration object accessible throughout application
- [x] Unit tests verify config loading and validation

## Completion Notes

- Viper-based configuration system fully implemented in `/internal/config/config.go`
- Support for all required configuration sections: database, m3u, filters, logging, api
- Environment variable overrides working (DATABASE_URL, M3U_PATH, LOG_LEVEL, API_PORT)
- Configuration validation implemented in `Validate()` method
- Example configuration file created at `config.yml.example`
- Global configuration singleton accessible via `config.Get()`
- Comprehensive unit tests in `config_test.go` (all passing)
