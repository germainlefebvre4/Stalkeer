# Task 2.5: Dry-Run Mode Implementation

**Phase**: 2 (Core Functionality)  
**Complexity**: Medium  
**Status**: Completed

## Description

Create safe processing analysis mode that identifies issues without making database mutations.

## Details

- Create dry-run package at `/internal/dryrun/`
- Implement dry-run processing:
  - Parse M3U but limit to first 100 items
  - Apply all classification logic to items
  - Perform filter matching
  - Collect analysis without database writes

- Implement issue detection:
  - Unclassified items: items with low confidence classification
  - Missing metadata: items missing season/episode or resolution
  - TMDB mapping issues: items that would fail external ID matching
  - Duplicate detection: duplicates in input

- Generate human-readable action log:
  - List specific items and issues
  - Explain what would be processed
  - Categorize by severity (info, warning, error)

- REST API endpoint:
  - `POST /api/v1/dryrun` - Execute dry-run
  - Request body: optional limit (default: 100, max: 1000)
  - Response: DryRunResult with categorized issues

- Response structure (DryRunResult):
  ```json
  {
    "total_processed": 100,
    "timestamp": "2026-01-29T10:00:00Z",
    "unclassified": [
      {
        "tvg_name": "...",
        "group_title": "...",
        "issues": ["low_confidence_type", "missing_season_episode"]
      }
    ],
    "missing_metadata": [...],
    "tmdb_issues": [...],
    "summary": {
      "total_issues": 15,
      "by_category": {...}
    }
  }
  ```

- Performance requirements:
  - Dry-run with 100 items completes in <5 seconds
  - No database transactions or locks

- Unit tests:
  - Test issue detection for various content types
  - Test response format
  - Test performance with 100+ items

## Dependencies

- Task 2.1 (M3U Parser)
- Task 2.2 (Content Classification)
- Task 2.3 (Filter System)
- Task 2.4 (REST API)

## Acceptance Criteria

- [x] Dry-run executes without database writes
- [x] Completes in <5 seconds for 100 items
- [x] Accurately identifies unclassified content
- [x] Accurately identifies missing metadata
- [x] Response format matches specification
- [x] Unit tests verify issue detection
- [x] Endpoint properly integrated with REST API

## Completion Notes

- Full dry-run implementation in `/internal/dryrun/dryrun.go`
- Analyzer with configurable processing limit
- Issue detection categories:
  - Unclassified items (low confidence, uncategorized content type)
  - Missing metadata (season/episode, resolution)
  - Filtered out items (by filter rules)
  - Duplicate entries
- Severity levels: info, warning, error
- Content type tracking in summary statistics
- Human-readable summary output with `PrintSummary()` function
- JSON-serializable Result structure for API responses
- CLI command `dryrun` with `--limit` flag
- Integration with classifier and filter systems
- Sample issue display (first 5 items per category)
- Timestamp tracking for analysis runs
- No database operations performed (analysis only)
- Tested with sample M3U files successfully
