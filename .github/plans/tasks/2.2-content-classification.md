# Task 2.2: Content Classification Engine

**Phase**: 2 (Core Functionality)  
**Complexity**: Large  
**Status**: Not Started

## Description

Implement intelligent content classification engine to automatically detect movies vs. series and extract metadata like season/episode numbers and resolution.

## Details

- Create classifier package at `/internal/classifier/`
- Implement season/episode extraction:
  - Regex patterns for common formats:
    - Standard: S01E05, S1E5
    - Words: Season 1 Episode 5, Season 01 Episode 05
    - Alternative: 1x05, 01x05
    - No leading zeros: s1e5
    - International variations (French, Spanish, German patterns)
  - Return (season, episode) tuple or nil if not found
  - Handle edge cases: Roman numerals, special episode formats (specials)

- Implement resolution detection:
  - Keyword-based approach:
    - 4K, UHD, 2160p → "4K"
    - 1080p, FullHD, FHD → "1080p"
    - 720p, HD → "720p"
    - 480p, SD → "480p"
  - Return detected resolution or nil if ambiguous
  - Case-insensitive matching

- Implement content type classification:
  - Movie detection:
    - Absence of season/episode patterns
    - Year in parentheses typical of movies
    - Heuristic scoring
  - Series detection:
    - Presence of season/episode markers
    - Multiple episode-like patterns
    - Keywords like "series", "season"
  - Uncategorized fallback for ambiguous cases

- Add confidence scoring:
  - Return confidence percentage (0-100)
  - High confidence (>80%): reliable classification
  - Low confidence (<50%): mark for manual review

- Create comprehensive test suite:
  - 50+ title patterns covering diverse formats
  - International titles (French, Spanish, German, Japanese)
  - Edge cases: malformed titles, ambiguous patterns
  - Performance tests (classify 10k titles)

- Performance optimization:
  - Precompile regex patterns at initialization
  - Cache classification results

## Dependencies

- Task 1.4 (Unit test foundation)

## Acceptance Criteria

- [ ] Season/episode extraction correct for 95%+ of test patterns
- [ ] Resolution detection accurate for all standard formats
- [ ] Content type classification correct for 90%+ of test data
- [ ] International titles handled appropriately
- [ ] All unit tests pass
- [ ] Classification of 10k titles completes in <5 seconds
- [ ] Edge cases documented and handled
